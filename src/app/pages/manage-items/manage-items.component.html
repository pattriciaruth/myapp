<h1>Manage Inventory</h1>

<div class="manage-layout">
  <!-- LEFT COLUMN – FORM -->
  <section class="left-column">
    <div class="form-box">
      <h3>{{ isEditing ? 'Edit Item' : 'Add New Item' }}</h3>

      <div class="message" *ngIf="message">{{ message }}</div>

      <label>Item ID:</label>
      <input [(ngModel)]="itemId" />

      <label>Name:</label>
      <input [(ngModel)]="name" />

      <label>Category:</label>
      <select [(ngModel)]="category">
        <option *ngFor="let c of categories">{{ c }}</option>
      </select>

      <label>Quantity:</label>
      <input type="number" [(ngModel)]="quantity" min="0" />

      <label>Price:</label>
      <input type="number" min="0" [(ngModel)]="price" />

      <label>Supplier:</label>
      <input [(ngModel)]="supplier" />

      <label>Stock Level (1 = Minimum, 5 = Maximum):</label>
      <input type="number" min="1" max="5" [(ngModel)]="stockLevel" />

      <div class="checkbox-row">
        <input id="popular" type="checkbox" [(ngModel)]="popular" />
        <label for="popular">Popular Item</label>
      </div>

      <label>Comment:</label>
      <textarea [(ngModel)]="comment"></textarea>

      <div class="button-row">
        <button (click)="isEditing ? saveEdit() : addItem()">
          {{ isEditing ? 'Save Changes' : 'Add Item' }}
        </button>

        <button *ngIf="isEditing" class="secondary" (click)="resetForm()">
          Cancel
        </button>
      </div>
    </div>
  </section>

  <!-- RIGHT COLUMN – SEARCH + TABLE -->
  <section class="right-column">
    <div class="card search-card">
      <h2>Search Inventory</h2>
      <input
        placeholder="Search by name..."
        #searchInput
        (input)="search(searchInput.value)"
      />

      <ul *ngIf="searchResults.length > 0" class="search-results">
        <li *ngFor="let r of searchResults">
          <span class="pill">{{ r.category }}</span>
          {{ r.name }}
        </li>
      </ul>

      <p *ngIf="searchResults.length === 0" class="small-note">
        Type a name to see matching items.
      </p>
    </div>

    <div class="card table-card">
      <div class="table-header-row">
        <h2>All Items</h2>
        <p class="small-note">
          Items are stored in memory only while this page is open.
        </p>
      </div>

      <div class="table-wrapper">
        <table *ngIf="items.length > 0; else emptyState">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Category</th>
              <th>Qty</th>
              <th>Price</th>
              <th>Stock (1–5)</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let item of items">
              <td>{{ item.itemId }}</td>
              <td>{{ item.name }}</td>
              <td>{{ item.category }}</td>
              <td>{{ item.quantity }}</td>
              <td>{{ item.price | currency: 'AUD':'symbol' }}</td>
              <td>
                <span class="stock-pill" [ngClass]="'lvl-' + item.stockLevel">
                  {{ item.stockLevel }} / 5
                </span>
              </td>
              <td class="actions">
                <button class="ghost" (click)="startEdit(item)">Edit</button>
                <button class="danger" (click)="deleteItem(item.name)">
                  Delete
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <ng-template #emptyState>
          <p class="empty-note">No items added yet. Start by adding one.</p>
        </ng-template>
      </div>
    </div>
  </section>
</div>
